/*
 * Copyright 2025 coze-dev Authors
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

// THIS IS AN AUTOGENERATED FILE. DO NOT EDIT THIS FILE DIRECTLY.
/* eslint-disable */
/* tslint:disable */
// @ts-nocheck

import * as datasetv2 from './datasetv2';
import * as datasetv2job from './datasetv2job';

export type Int64 = string | number;

export enum BatchInferDatasetType {
  DatasetV2 = 0,
  HDFS = 1,
  TOS = 2,
}

export enum BatchInferTaskStatus {
  Preparing = 0,
  Launching = 1,
  Inferring = 2,
  Exporting = 3,
  Success = 4,
  Failed = 5,
  Terminated = 6,
}

export enum InputConfigType {
  Raw = 1,
}

export enum MerlinQuotaPoolType {
  /** 穩定資源 */
  Default = 0,
  /** 潮汐資源 */
  Hybrid = 1,
  /** 常混資源 */
  HybridShare = 2,
  /** 第三方資源ali */
  ALI = 3,
  /** 第三方資源hw */
  HW = 4,
  /** hw arm */
  HWARM = 5,
  /** 彈性售賣資源，隨時可能被搶佔 */
  Spot = 6,
  /** 可搶佔的穩定資源，merlin seed離線推理不允許選這種資源 */
  Preemptible = 20,
}

export enum MerlinSeedDataProcessType {
  /** 普通生成任務 */
  RayDataset = 1,
  /** 多輪生成任務 */
  RayDatasetMultiround = 2,
}

export enum MerlinSeedModelType {
  HDFS = 1,
  ModelCard = 2,
}

export enum OutputConfigType {
  Raw = 1,
}

export enum Provider {
  /** GPTOpenAPI = 1 // GPT OpenAPI平臺
火山方舟 */
  Maas = 2,
  /** BotEngine  = 3 // 暫時特指seed從bot_engine接入
merlin平臺 */
  Merlin = 4,
  /** merlin-seed平臺 */
  MerlinSeed = 5,
}

export enum TrainingMethod {
  LoRA = 1,
  Full = 2,
}

export enum TrainingType {
  SftFineTuning = 1,
}

export interface ArkModel {
  foundationModelName?: string;
  foundationModelVersion?: string;
  /** 如果是精調後的模型，這個id非空 */
  customModelID?: string;
  sftTaskID?: string;
  /** 訓練類型 */
  trainingType?: TrainingType;
  /** 訓練方法 */
  trainingMethod?: TrainingMethod;
}

export interface BatchInferDataset {
  datasetID?: string;
  inputConfig?: InputConfig;
  outputConfig?: OutputConfig;
  /** 默認是數據集v2，本期新增hdfs和tos */
  datasetType?: BatchInferDatasetType;
  /** 待推理的數據集hdfs路徑 */
  hdfsPath?: string;
  /** 待推理的圖片存儲的文件夾路徑 */
  imageHdfsPath?: string;
  /** 輸出結果保存的hdfs路徑 */
  outputHdfsPath?: string;
  /** 待推理的數據集的tos桶名 */
  tosBucketName?: string;
  /** 待推理的數據集的tos對象名稱 */
  tosObjKey?: string;
  /** 輸出結果保存的tos桶名 */
  outputTosBucketName?: string;
  /** 輸出結果保存的tos對象名稱 */
  outputTosObjKey?: string;
}

export interface BatchInferParam {
  temperature?: number;
  topP?: number;
  topK?: string;
  maxNewToken?: string;
  maxContextToken?: string;
  /** 推理次數 */
  inferTimes?: string;
  /** 推理批次大小 */
  batchSize?: string;
}

export interface BatchInferTask {
  /** 創建時不傳 */
  id?: Int64;
  name?: string;
  desc?: string;
  batchInferParam?: BatchInferParam;
  provider?: Provider;
  providerInfo?: ProviderInfo;
  providerTaskID?: string;
  batchInferDatasets?: Array<BatchInferDataset>;
  ckptConfigs?: Record<string, CkptConfig>;
  status?: BatchInferTaskStatus;
  errCode?: string;
  errMsg?: string;
  ckptExecRes?: CkptExecResult;
  /** Fornax空間ID */
  spaceID?: string;
  /** 創建人ID */
  createdBy?: string;
  /** 創建時間，秒 */
  createdAt?: string;
  /** 更新人ID */
  updatedBy?: string;
  /** 更新時間，秒 */
  updatedAt?: string;
}

export interface CkptConfig {
  name?: string;
  maxRetryTime?: string;
  retryIntervalMilliSecond?: string;
  /** 重試時間間隔的變化方式，支持固定間隔和隨時間漸進式變化 */
  retryIntervalChangeType?: string;
  /** 每重試x次，重試時間間隔會發生變化 */
  retryIntervalChangeTimes?: string;
  /** 每次重試時間間隔變化的步長，單位爲ms，可以爲負數 */
  retryIntervalChangeStep?: string;
  customConfigs?: Record<string, string>;
  /** 觸發下一個checkpoint的時間間隔，單位爲ms */
  triggerNextCkptIntervalMilliSecond?: string;
}

export interface CkptExecResult {
  /** 上傳數據集到HDFS  [1,10)
數據集上傳到hdfs的地址 */
  datasetHdfsAddress?: string;
  /** 上傳進度，長度與 batchInferDatasets 相同 */
  datasetUploadProgresses?: Array<InferUploadProgress>;
  /** 傳入離線推理任務的數據列名 */
  inferTaskColumnName?: string;
  /** item id 所在的列名 */
  itemIDColumnName?: string;
  /** dataset id 所在的列名 */
  datasetIDColumnName?: string;
  /** 數據集上傳到 tos 的 bucket */
  datasetTosBucket?: string;
  /** 數據集上傳到 tos 的object key */
  datasetTosObjectKey?: string;
  /** 創建推理任務 [10,20)
merlin seed離線推理任務實際上就是在merlin任務用例外包了一層，在這裏記錄這個merlin任務用例id */
  merlinJobID?: string;
  /** merlin seed離線推理任務鏈接 */
  merlinDataProcessTaskUrl?: string;
  /** 第三方平臺任務鏈接 */
  providerTaskUrl?: string;
  /** 檢查推理任務狀態 [20,30)
merlin推理任務狀態 */
  merlinDataProcessInstanceStatusGroup?: string;
  /** merlin推理任務狀態詳情 */
  merlinDataProcessInstanceStatus?: string;
  /** merlin 任務實例是否終止 */
  merlinJobTerminated?: boolean;
  /** merlin 任務實例狀態 */
  merlinJobStatus?: string;
  /** merlin 任務實例錯誤信息 */
  merlinJobErrMsg?: string;
  /** 有merlin 任務實例上報的錯誤信息 */
  merlinJobUploadedErrMsg?: string;
  /** 方舟任務狀態 */
  arkJobStatus?: string;
  /** 方舟任務狀態說明 */
  arkJobDetail?: string;
  /** 方舟任務狀態更新時間 */
  arkJobStatusUpdateTimeMs?: Int64;
  /** 導出推理結果 [30,40)
推理結果輸出的列名 */
  inferResultColumnName?: string;
  /** 推理結果保存的hdfs地址，可能爲文件夾 */
  inferResultHdfsAddress?: string;
  /** 結果是否導出完成 */
  resultExported?: boolean;
  /** 推理結果導出進度 */
  inferExportProgress?: InferExportProgress;
}

export interface InferExportProgress {
  /** 推理結果的存儲平臺 */
  provider?: datasetv2.StorageProvider;
  /** 推理結果的文件格式，如果結果的路徑是文件夾，那麼只導出這個文件夾下所有該格式的文件 */
  fileFormat?: datasetv2job.FileFormat;
  /** 導出結果的地址，可以是文件夾 */
  path?: string;
  /** 子進度（所有結果文件的進度） */
  subProgresses?: Array<InferExportProgress>;
  /** 進度信息
總行數 */
  total?: Int64;
  /** 已處理的行數 */
  processed?: Int64;
  /** 添加成功的行數 */
  added?: Int64;
  /** 運行日誌
錯誤信息，子進度中無該字段 */
  errors?: Array<datasetv2.ItemErrorGroup>;
}

export interface InferUploadProgress {
  /** 需要上傳到的存儲平臺 */
  provider?: datasetv2.StorageProvider;
  /** 需要上傳的文件格式 */
  fileFormat?: datasetv2job.FileFormat;
  /** 上傳的地址 */
  path?: string;
  /** 子進度（所有上傳文件的進度） */
  subProgresses?: Array<InferExportProgress>;
  /** 需要上傳的數據集 ID，在子進度中無該字段 */
  datasetID?: Int64;
  /** 當前數據集上傳的 cursor，在子進度中無該字段 */
  cursor?: string;
  /** 進度信息
總行數 */
  total?: Int64;
  /** 已處理的行數 */
  processed?: Int64;
}

export interface InputConfig {
  type?: InputConfigType;
  /** 作爲輸入的數據集列名 */
  rawInput?: string;
  /** 每行數據的唯一標識的列名 */
  itemID?: string;
}

export interface MerlinModel {
  /** 多記錄一些額外信息，比如是基座模型還是訓練後的模型，如果是訓練後的模型，那麼還需要記錄訓練任務的id
模型文件保存地址 */
  hdfsPath?: string;
  /** 基座模型名稱 */
  foundationModelName?: string;
  /** 3: optional string foundationModelFamily // 基座模型家族
4: optional string foundationModelVendor // 基座模型廠商
5: optional string foundationModelDisplayName // 基座模型顯示名稱
6: optional i64 foundationModelVersionUpdateTimeInMs // 基座模型版本更新時間
訓練任務id，當訓練任務非0時，說明此次批量推理使用的模型是訓練後的產物 */
  sftTaskID?: string;
  /** 訓練產物的名稱(此時要求該產物已經導出到merlin的模型倉庫中，因此這個name就是merlin的某個模型倉庫名稱) */
  merlinModelName?: string;
  /** merlin的某個模型倉庫的版本 */
  merlinModelVersion?: string;
  /** 訓練類型 */
  trainingType?: TrainingType;
  /** 訓練方法 */
  trainingMethod?: TrainingMethod;
}

export interface MerlinResource {
  type?: MerlinQuotaPoolType;
  /** 用戶組id，暫時只支持1個 */
  groupIDs?: Array<string>;
  /** 集羣id */
  clusterID?: string;
  /** 是否使用可佔用資源 */
  preemptible?: boolean;
  /** 角色配置，暫時只支持1個 */
  roles?: Array<MerlinResourceRole>;
  /** key是用戶組id，val是用戶組名稱 */
  groupNames?: Record<Int64, string>;
  /** 集羣名稱 */
  clusterName?: string;
}

export interface MerlinResourceRole {
  /** 實例數，必填1 */
  num?: number;
  /** 虛擬gpu型號 */
  gpuv?: string;
  /** gpu數量 */
  gpu?: number;
  /** cpu數量 */
  cpu?: number;
  /** 內存大小，單位是MB */
  memory?: number;
}

export interface MerlinSeedModel {
  merlinSeedModelType?: MerlinSeedModelType;
  hdfsAddress?: string;
  modelCardID?: string;
  modelCardName?: string;
  modelParamConfigType?: string;
  tokenizerAddress?: string;
  networkConfig?: string;
  quantConfig?: string;
}

export interface ModelCard {
  id?: string;
  name?: string;
}

export interface OutputConfig {
  type?: OutputConfigType;
  /** 輸出會保存在這個數據集列名 */
  rawOutput?: string;
  /** 完整輸出會保存在這個數據集列名（目前只支持方舟/開源模型/訓練後的開源模型） */
  completeOutput?: string;
}

export interface ProviderInfo {
  provider?: Provider;
  merlinSeedModel?: MerlinSeedModel;
  merlinResource?: MerlinResource;
  merlinCustomEnvs?: Record<string, string>;
  merlinSeedDataProcessType?: MerlinSeedDataProcessType;
  /** open source model */
  merlinModel?: MerlinModel;
  /** 方舟model */
  arkModel?: ArkModel;
  /** 方舟項目名稱 */
  arkProjectName?: string;
}
/* eslint-enable */
