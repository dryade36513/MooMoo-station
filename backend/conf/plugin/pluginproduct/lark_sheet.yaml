info:
  description: |-
    對飛書電子表格做操作，包含以下操作：
    1.創建電子表格；
    2.新增多行至工作表；
    3.新增多列至工作表；
    4.搜索電子表格類型文檔；
    5.獲取電子表格信息；
    6.獲取所有工作表；
    7.讀取工作表行列內容；
  title: 飛書電子表格
  version: v1
openapi: 3.0.1
paths:
  /spreadsheet/add_cols:
    post:
      operationId: add_cols
      requestBody:
        content:
          application/json:
            schema:
              properties:
                length:
                  description: 要增加的列數
                  type: number
                sheet_id:
                  description: 工作表 ID，與sheet_name二者其一必填
                  type: string
                sheet_name:
                  description: 工作表名稱，與sheet_id二者其一必填
                  type: string
                spreadsheet_token:
                  description: 電子表格 token，支持輸入電子表格 url
                  type: string
                values:
                  description: 新增列的單元格內容，數組對象字符串，每個數組一行表格數據，格式：[["編號","姓名","年齡"],[1,"張三",10],[2,"李四",11]]
                  type: string
              required:
                - spreadsheet_token
                - length
              type: object
      responses:
        "200":
          content:
            application/json:
              schema:
                properties:
                  code:
                    description: 錯誤碼，非 0 表示失敗
                    type: integer
                  data:
                    description: 返回數據
                    properties:
                      addCount:
                        description: 增加的列數
                        type: number
                      majorDimension:
                        description: 增加的表維度，COLUMNS：列
                        type: string
                    type: object
                  log_id:
                    description: 鏈路追蹤 id
                    type: string
                  msg:
                    description: 錯誤描述
                    type: string
                type: object
          description: new desc
        default:
          description: ""
      summary: 新增多列至工作表最後
  /spreadsheet/add_rows:
    post:
      operationId: add_rows
      requestBody:
        content:
          application/json:
            schema:
              properties:
                length:
                  description: 要增加行數，範圍(0-5000]
                  type: number
                sheet_id:
                  description: 工作表 ID，與sheet_name二者其一必填
                  type: string
                sheet_name:
                  description: 工作表名稱，與sheet_id二者其一必填
                  type: string
                spreadsheet_token:
                  description: 電子表格 token，支持輸入電子表格 url
                  type: string
                values:
                  description: 新增行的表格內容，數組對象字符串，每個數組一行表格數據，格式,如：[["編號","姓名","年齡"],[1,"張三",10],[2,"李四",11]]
                  type: string
              required:
                - spreadsheet_token
                - length
              type: object
      responses:
        "200":
          content:
            application/json:
              schema:
                properties:
                  code:
                    description: 錯誤碼，非 0 表示失敗
                    type: integer
                  data:
                    description: 返回數據
                    properties:
                      addCount:
                        description: 增加的行數
                        type: number
                      majorDimension:
                        description: 增加的表格維度,ROWS：行
                        type: string
                    type: object
                  log_id:
                    description: 鏈路追蹤 id
                    type: string
                  msg:
                    description: 錯誤描述
                    type: string
                type: object
          description: new desc
        default:
          description: ""
      summary: 新增多行至工作表最後
  /spreadsheet/create_spreadsheet:
    post:
      operationId: create_spreadsheet
      requestBody:
        content:
          application/json:
            schema:
              properties:
                folder_token:
                  description: 文件夾 token，支持文件夾url輸入，如：https://bytedance.larkoffice.com/drive/folder/CxHEf4DCSlNkL2dUTCJcPRgentg
                  type: string
                title:
                  description: 電子表格標題
                  type: string
              type: object
      responses:
        "200":
          content:
            application/json:
              schema:
                properties:
                  code:
                    description: 錯誤碼，非 0 表示失敗
                    type: integer
                  data:
                    description: 返回數據
                    properties:
                      spreadsheet:
                        description: 電子表格的基礎信息
                        properties:
                          folder_token:
                            description: 文件夾 token
                            type: string
                          spreadsheet_token:
                            description: 電子表格 token
                            type: string
                          title:
                            description: 電子表格標題
                            type: string
                          url:
                            description: 電子表格的 URL 鏈接
                            type: string
                        type: object
                    type: object
                  log_id:
                    description: 鏈路追蹤 id
                    type: string
                  msg:
                    description: 錯誤描述
                    type: string
                type: object
          description: new desc
        default:
          description: ""
      summary: 創建電子表格
  /spreadsheet/delete_cols:
    delete:
      operationId: delete_cols
      requestBody:
        content:
          application/json:
            schema:
              properties:
                end_index:
                  description: 要刪除的列結束的位置。從 1 開始計數
                  type: number
                sheet_id:
                  description: 工作表的 ID
                  type: string
                sheet_name:
                  description: 工作表的名稱
                  type: string
                spreadsheet_token:
                  description: 電子表格的 token，支持填寫電子表格的 URL或Token
                  type: string
                start_index:
                  description: 要刪除的列結束的位置。從 1 開始計數
                  type: number
              required:
                - spreadsheet_token
                - start_index
                - end_index
              type: object
        description: new desc
      responses:
        "200":
          content:
            application/json:
              schema:
                properties:
                  code:
                    description: 錯誤碼
                    type: integer
                  data:
                    properties:
                      delCount:
                        description: 一共刪除的列數
                        type: number
                      majorDimension:
                        description: 刪除的維度，COLUMNS：代表列
                        type: string
                    type: object
                  log_id:
                    description: 日誌ID
                    type: string
                  msg:
                    description: 錯誤信息
                    type: string
                type: object
          description: new desc
        default:
          description: ""
      summary: 刪除電子表格工作表列
  /spreadsheet/delete_rows:
    delete:
      operationId: delete_rows
      requestBody:
        content:
          application/json:
            schema:
              properties:
                end_index:
                  description: 要刪除的行結束的位置。從 1 開始計數
                  type: number
                sheet_id:
                  description: 工作表的 ID
                  type: string
                sheet_name:
                  description: 工作表名稱
                  type: string
                spreadsheet_token:
                  description: 電子表格的 token，支持填寫電子表格的 URL或Token
                  type: string
                start_index:
                  description: 要刪除的行起始位置，從 1 開始計數
                  type: number
              required:
                - spreadsheet_token
                - start_index
                - end_index
              type: object
        description: new desc
      responses:
        "200":
          content:
            application/json:
              schema:
                properties:
                  code:
                    description: 錯誤碼
                    type: integer
                  data:
                    properties:
                      delCount:
                        description: 一共刪除的行數
                        type: number
                      majorDimension:
                        description: 刪除的維度。ROWS：代表行
                        type: string
                    type: object
                  log_id:
                    description: 日誌ID
                    type: string
                  msg:
                    description: 錯誤信息
                    type: string
                type: object
          description: new desc
        default:
          description: ""
      summary: 刪除電子表格工作表行
  /spreadsheet/get_spreadsheet:
    get:
      operationId: get_spreadsheet
      parameters:
        - description: 電子表格 token，支持輸入電子表格 url
          in: query
          name: spreadsheet_token
          required: true
          schema:
            type: string
        - description: 用戶 ID 類型
          in: query
          name: user_id_type
          schema:
            default: open_id
            type: string
      requestBody:
        content:
          application/json:
            schema:
              type: object
      responses:
        "200":
          content:
            application/json:
              schema:
                properties:
                  code:
                    description: 錯誤碼，非 0 表示失敗
                    type: integer
                  data:
                    description: 返回數據
                    properties:
                      spreadsheet:
                        description: 電子表格的基礎信息
                        properties:
                          owner_id:
                            description: 電子表格的所有者 ID，ID 類型由查詢參數 user_id_type 決定
                            type: string
                          title:
                            description: 電子表格標題
                            type: string
                          token:
                            description: 電子表格 token
                            type: string
                          url:
                            description: 電子表格的 URL 鏈接
                            type: string
                        type: object
                    type: object
                  log_id:
                    description: 鏈路追蹤 id
                    type: string
                  msg:
                    description: 錯誤描述
                    type: string
                type: object
          description: new desc
        default:
          description: ""
      summary: 獲取電子表格信息
  /spreadsheet/list_spreadsheet_sheets:
    get:
      operationId: list_spreadsheet_sheets
      parameters:
        - description: 電子表格 token，支持輸入電子表格 url
          in: query
          name: spreadsheet_token
          required: true
          schema:
            type: string
      requestBody:
        content:
          application/json:
            schema:
              type: object
      responses:
        "200":
          content:
            application/json:
              schema:
                properties:
                  code:
                    description: 錯誤碼，非 0 表示失敗
                    type: integer
                  data:
                    description: 返回數據
                    properties:
                      sheets:
                        description: 工作表列表
                        items:
                          description: 工作表信息
                          properties:
                            grid_properties:
                              description: 單元格屬性，僅當 resource_type 爲 sheet 即工作表類型爲電子表格時返回
                              properties:
                                column_count:
                                  description: 工作表的列數量
                                  type: number
                                frozen_column_count:
                                  description: 凍結的列數量
                                  type: number
                                frozen_row_count:
                                  description: 凍結的行數量
                                  type: number
                                row_count:
                                  description: 工作表的行數
                                  type: number
                              type: object
                            hidden:
                              description: 工作表是否被隱藏，true：被隱藏，false：未被隱藏
                              type: boolean
                            index:
                              description: 工作表索引位置，索引從 0 開始計數
                              type: integer
                            merges:
                              description: 合併單元格的相關信息，沒有合併單元格則不返回
                              items:
                                description: 單元格信息
                                properties:
                                  end_column_index:
                                    description: 結束列，從 0 開始計數
                                    type: number
                                  end_row_index:
                                    description: 結束行，從 0 開始計數
                                    type: number
                                  start_column_index:
                                    description: 起始列，從 0 開始計數
                                    type: number
                                  start_row_index:
                                    description: 起始行，從 0 開始計數
                                    type: number
                                type: object
                              type: array
                            resource_type:
                              description: 工作表類型，sheet：工作表，bitable：多維表格，#UNSUPPORTED_TYPE：不支持的類型
                              type: string
                            sheet_id:
                              description: 工作表 ID
                              type: string
                            title:
                              description: 工作表標題
                              type: string
                          type: object
                        type: array
                    type: object
                  log_id:
                    description: 鏈路追蹤 id
                    type: string
                  msg:
                    description: 錯誤描述
                    type: string
                type: object
          description: new desc
        default:
          description: ""
      summary: 獲取電子表格所有工作表
  /spreadsheet/read_cols:
    get:
      operationId: read_cols
      parameters:
        - description: 電子表格 token，支持輸入電子表格 url
          in: query
          name: spreadsheet_token
          required: true
          schema:
            type: string
        - description: 工作表 ID，與sheet_name二者其一必填
          in: query
          name: sheet_id
          schema:
            type: string
        - description: 用戶 ID 類型，默認 open_id
          in: query
          name: user_id_type
          schema:
            default: open_id
            type: string
        - description: 起始列號，從1開始
          in: query
          name: start_col
          schema:
            default: 1
            type: integer
        - description: 讀取列數
          in: query
          name: num_cols
          required: true
          schema:
            type: integer
        - description: 工作表名稱，與sheet_id二者其一必填
          in: query
          name: sheet_name
          schema:
            type: string
      requestBody:
        content:
          application/json:
            schema:
              type: object
      responses:
        "200":
          content:
            application/json:
              schema:
                properties:
                  code:
                    description: 錯誤碼，非 0 表示失敗
                    type: integer
                  data:
                    description: 返回數據
                    properties:
                      revision:
                        description: 工作表的版本號。從 0 開始計數，更新一次版本號加一。
                        type: number
                      spreadsheetToken:
                        description: 表格 token
                        type: string
                      valueRange:
                        description: 讀取的值與範圍
                        properties:
                          majorDimension:
                            description: 返回的 values 數組中數據的呈現維度。固定取值 ROWS，即數據爲從左到右、從上到下的讀取順序
                            type: string
                          range:
                            description: 讀取的範圍。爲空時表示查詢範圍沒有數據。
                            type: string
                          revision:
                            description: 工作表的版本號。從 0 開始計數，更新一次版本號加一
                            type: number
                          valuesJsonString:
                            description: 返回的數據內容
                            type: string
                        type: object
                    type: object
                  log_id:
                    description: 鏈路追蹤 id
                    type: string
                  msg:
                    description: 返回信息
                    type: string
                type: object
          description: new desc
        default:
          description: ""
      summary: 讀取工作表列數據
  /spreadsheet/read_rows:
    get:
      operationId: read_rows
      parameters:
        - description: 電子表格 token，支持輸入電子表格 url
          in: query
          name: spreadsheet_token
          required: true
          schema:
            type: string
        - description: 工作表 ID，與sheet_name二者其一必填
          in: query
          name: sheet_id
          schema:
            type: string
        - description: 用戶 ID 類型
          in: query
          name: user_id_type
          schema:
            default: open_id
            type: string
        - description: 起始行號，從1開始
          in: query
          name: start_row
          schema:
            default: 1
            type: integer
        - description: 讀取行數
          in: query
          name: num_rows
          required: true
          schema:
            type: integer
        - description: 工作表名稱，與sheet_id二者其一必填
          in: query
          name: sheet_name
          schema:
            type: string
      requestBody:
        content:
          application/json:
            schema:
              type: object
      responses:
        "200":
          content:
            application/json:
              schema:
                properties:
                  code:
                    description: 錯誤碼，非 0 表示失敗
                    type: number
                  data:
                    description: 返回數據
                    properties:
                      revision:
                        description: 工作表的版本號。從 0 開始計數，更新一次版本號加一
                        type: number
                      spreadsheetToken:
                        description: 表格的 token
                        type: string
                      valueRange:
                        description: 讀取的值與範圍
                        properties:
                          majorDimension:
                            description: 返回的 values 數組中數據的呈現維度。固定取值 ROWS，即數據爲從左到右、從上到下的讀取順序。
                            type: string
                          range:
                            description: 讀取的範圍
                            type: string
                          revision:
                            description: 工作表的版本號。從 0 開始計數，更新一次版本號加一
                            type: number
                          valuesJsonString:
                            description: 讀取的表格內容
                            type: string
                        type: object
                    type: object
                  log_id:
                    description: 鏈路追蹤 id
                    type: string
                  msg:
                    description: 錯誤描述
                    type: string
                type: object
          description: new desc
        default:
          description: ""
      summary: 讀取工作表行數據
  /spreadsheet/read_table:
    get:
      operationId: read_table
      parameters:
        - description: 電子表格 token，支持輸入電子表格 url
          in: query
          name: spreadsheet_token
          required: true
          schema:
            type: string
        - description: 工作表 ID，與sheet_name二者其一必填
          in: query
          name: sheet_id
          schema:
            type: string
        - description: '用戶 ID 類型 '
          in: query
          name: user_id_type
          schema:
            default: open_id
            type: string
        - description: 取數範圍,格式如:A1:B2，query=all時可爲空
          in: query
          name: range
          schema:
            type: string
        - description: 傳 all,表示查詢表格所有數據,但最多查詢100列數據
          in: query
          name: query
          schema:
            type: string
        - description: 工作表名稱，與sheet_id二者其一必填
          in: query
          name: sheet_name
          schema:
            type: string
      requestBody:
        content:
          application/json:
            schema:
              type: object
      responses:
        "200":
          content:
            application/json:
              schema:
                properties:
                  code:
                    description: 錯誤碼，非 0 表示失敗
                    type: integer
                  data:
                    description: 返回數據
                    properties:
                      revision:
                        description: 工作表的版本號。從 0 開始計數，更新一次版本號加一。
                        type: number
                      spreadsheetToken:
                        description: 電子表格 token
                        type: string
                      valueRange:
                        description: 讀取的值與範圍
                        properties:
                          majorDimension:
                            description: 返回的 values 數組中數據的呈現維度。固定取值 ROWS，即數據爲從左到右、從上到下的讀取順序。
                            type: string
                          range:
                            description: 讀取的範圍。爲空時表示查詢範圍沒有數據。
                            type: string
                          revision:
                            description: 工作表的版本號。從 0 開始計數，更新一次版本號加一。
                            type: number
                          valuesJsonString:
                            description: 讀取的表格數據內容
                            type: string
                        type: object
                    type: object
                  log_id:
                    description: 鏈路追蹤 id
                    type: string
                  msg:
                    description: 錯誤信息
                    type: string
                type: object
          description: new desc
        default:
          description: ""
      summary: 自定義讀取電子表格行列數據
  /spreadsheet/search_spreadsheet:
    post:
      operationId: search_spreadsheet
      requestBody:
        content:
          application/json:
            schema:
              properties:
                count:
                  description: 指定搜索返回的文件數量，取值範圍爲 [0,50]
                  type: integer
                offset:
                  description: 指定搜索的偏移量，該參數最小爲 0，即不偏移。該參數的值與返回的文件數量之和不得小於或等於 200（即 offset + count < 200）
                  type: integer
                search_key:
                  description: 指定搜索的關鍵字
                  type: string
              required:
                - search_key
              type: object
      responses:
        "200":
          content:
            application/json:
              schema:
                properties:
                  code:
                    description: 錯誤碼，非 0 表示失敗
                    type: integer
                  data:
                    description: 返回數據
                    properties:
                      docs_entities:
                        description: 包含搜索關鍵詞的文件列表
                        items:
                          description: 文件列表
                          properties:
                            docs_token:
                              description: 文件 token
                              type: string
                            docs_type:
                              description: 文件類型
                              type: string
                            owner_id:
                              description: 文件所有者
                              type: string
                            title:
                              description: 文件標題
                              type: string
                            url:
                              description: 文檔鏈接
                              type: string
                          type: object
                        type: array
                      has_more:
                        description: 結果列表後是否還有數據
                        type: boolean
                      total:
                        description: 包含搜索關鍵詞的文件總數量
                        type: number
                    type: object
                  log_id:
                    description: 鏈路追蹤 id
                    type: string
                  msg:
                    description: 錯誤描述
                    type: string
                type: object
          description: new desc
        default:
          description: ""
      summary: 搜索電子表格
servers:
  - url: https://lark-plugin-api.solutionsuite.cn/lark-plugin
